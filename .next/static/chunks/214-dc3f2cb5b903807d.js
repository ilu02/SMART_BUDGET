"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[214],{8480:function(e,t,r){r.d(t,{BudgetProvider:function(){return c},h:function(){return l}});var o=r(7437),a=r(2265),i=r(1891),n=r(9064);let s=(0,a.createContext)(void 0);function c(e){let{children:t}=e,[r,c]=(0,a.useState)([]),[l,d]=(0,a.useState)(!0),{user:u,isAuthenticated:g}=(0,i.a)(),y=(0,a.useCallback)(async()=>{if(!(null==u?void 0:u.id)){c([]),d(!1);return}try{d(!0);let e=await fetch("/api/budgets?userId=".concat(u.id)),t=await e.json();e.ok&&t.success?c(t.budgets):(console.error("Failed to load budgets:",t.error),c([]))}catch(e){console.error("Error loading budgets:",e),c([])}finally{d(!1)}},[null==u?void 0:u.id]);(0,a.useEffect)(()=>{g&&u?y():(c([]),d(!1))},[u,g,y]);let f=async e=>{if(!(null==u?void 0:u.id)){n.ZP.error("User not authenticated");return}try{let t=await fetch("/api/budgets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,userId:u.id})}),r=await t.json();t.ok&&r.success?(c(e=>[...e,r.budget]),n.ZP.success("Budget added successfully!")):n.ZP.error(r.error||"Failed to add budget")}catch(e){console.error("Error adding budget:",e),n.ZP.error("Failed to add budget")}},p=async(e,t)=>{if(!(null==u?void 0:u.id)){n.ZP.error("User not authenticated");return}try{let r=await fetch("/api/budgets",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,...t})}),o=await r.json();r.ok&&o.success?(c(r=>r.map(r=>r.id===e?{...r,...t}:r)),n.ZP.success("Budget updated successfully!")):n.ZP.error(o.error||"Failed to update budget")}catch(e){console.error("Error updating budget:",e),n.ZP.error("Failed to update budget")}},h=async e=>{if(!(null==u?void 0:u.id)){n.ZP.error("User not authenticated");return}try{let t=await fetch("/api/budgets?id=".concat(e),{method:"DELETE"}),r=await t.json();t.ok&&r.success?(c(t=>t.filter(t=>t.id!==e)),n.ZP.success("Budget deleted successfully!")):n.ZP.error(r.error||"Failed to delete budget")}catch(e){console.error("Error deleting budget:",e),n.ZP.error("Failed to delete budget")}},m=(0,a.useCallback)(async()=>{await y()},[y]),b=()=>r.reduce((e,t)=>e+t.budget,0),v=()=>r.reduce((e,t)=>e+t.spent,0);return(0,o.jsx)(s.Provider,{value:{budgets:r,addBudget:f,updateBudget:p,deleteBudget:h,getBudgetByCategory:e=>r.find(t=>t.category===e),getTotalBudget:b,getTotalSpent:v,getTotalRemaining:()=>b()-v(),getOverallProgress:()=>{let e=b();return 0===e?0:v()/e*100},loading:l,refreshBudgets:m},children:t})}function l(){let e=(0,a.useContext)(s);if(void 0===e)throw Error("useBudgets must be used within a BudgetProvider");return e}},7081:function(e,t,r){r.d(t,{NotificationProvider:function(){return l},zn:function(){return d}});var o=r(7437),a=r(2265),i=r(9064),n=r(56);let s=(0,a.createContext)(void 0),c=[{id:"1",type:"budget",title:"Budget Alert: Food & Dining",message:"You've spent 85% of your monthly food budget (K850 of K1,000)",timestamp:new Date(Date.now()-72e5),read:!1,priority:"high",actionUrl:"/budgets",actionText:"View Budget",category:"Food & Dining",amount:850},{id:"2",type:"transaction",title:"Large Transaction Detected",message:"A transaction of K2,500 was recorded at SuperMart",timestamp:new Date(Date.now()-144e5),read:!1,priority:"medium",actionUrl:"/transactions",actionText:"View Transaction",amount:2500},{id:"3",type:"bill",title:"Bill Reminder",message:"Your electricity bill (K450) is due in 3 days",timestamp:new Date(Date.now()-216e5),read:!0,priority:"medium",actionUrl:"/transactions",actionText:"Pay Now",amount:450},{id:"4",type:"goal",title:"Savings Goal Achievement",message:"Congratulations! You've reached 75% of your vacation savings goal",timestamp:new Date(Date.now()-864e5),read:!0,priority:"low",actionUrl:"/dashboard",actionText:"View Goals"},{id:"5",type:"system",title:"Weekly Report Available",message:"Your weekly spending report is ready to view",timestamp:new Date(Date.now()-1728e5),read:!0,priority:"low",actionUrl:"/analytics",actionText:"View Report"}];function l(e){let{children:t}=e,[r,l]=(0,a.useState)([]),{notifications:d}=(0,n.r)();(0,a.useEffect)(()=>{(()=>{try{let e=localStorage.getItem("notifications");if(e){let t=JSON.parse(e).map(e=>({...e,timestamp:new Date(e.timestamp)}));l(t)}else l(c)}catch(e){console.error("Error loading notifications:",e),l(c)}})()},[]),(0,a.useEffect)(()=>{try{localStorage.setItem("notifications",JSON.stringify(r))}catch(e){console.error("Error saving notifications:",e)}},[r]);let u=r.filter(e=>!e.read).length;return(0,o.jsx)(s.Provider,{value:{notifications:r,unreadCount:u,addNotification:e=>{if(!(()=>{switch(e.type){case"budget":return d.budgetAlerts;case"transaction":return d.largeTransactions;case"bill":return d.billReminders;case"goal":return d.goalReminders;case"system":return d.productUpdates;default:return!0}})())return;let t={...e,id:Date.now().toString()+Math.random().toString(36).substr(2,9),timestamp:new Date,read:!1};l(e=>[t,...e]),d.pushNotifications&&("high"===e.priority||"urgent"===e.priority?i.ZP.error(e.title,{duration:5e3,icon:"\uD83D\uDEA8"}):"medium"===e.priority&&(0,i.ZP)(e.title,{duration:4e3,icon:"⚠️"}))},markAsRead:e=>{l(t=>t.map(t=>t.id===e?{...t,read:!0}:t))},markAllAsRead:()=>{l(e=>e.map(e=>({...e,read:!0})))},deleteNotification:e=>{l(t=>t.filter(t=>t.id!==e))},clearAllRead:()=>{l(e=>e.filter(e=>!e.read))},getNotificationsByType:e=>r.filter(t=>t.type===e)},children:t})}function d(){let e=(0,a.useContext)(s);if(void 0===e)throw Error("useNotifications must be used within a NotificationProvider");return e}},8251:function(e,t,r){r.d(t,{TransactionProvider:function(){return l},n:function(){return d}});var o=r(7437),a=r(2265),i=r(1891),n=r(9064);let s={"Food & Dining":{icon:"ri-restaurant-line",color:"text-blue-600 bg-blue-50"},Transportation:{icon:"ri-gas-station-line",color:"text-teal-600 bg-teal-50"},Entertainment:{icon:"ri-film-line",color:"text-pink-600 bg-pink-50"},Shopping:{icon:"ri-shopping-bag-line",color:"text-red-600 bg-red-50"},"Health & Fitness":{icon:"ri-heart-pulse-line",color:"text-orange-600 bg-orange-50"},Utilities:{icon:"ri-flashlight-line",color:"text-yellow-600 bg-yellow-50"},Education:{icon:"ri-book-line",color:"text-indigo-600 bg-indigo-50"},Travel:{icon:"ri-plane-line",color:"text-purple-600 bg-purple-50"},Income:{icon:"ri-money-dollar-circle-line",color:"text-green-600 bg-green-50"},Other:{icon:"ri-more-line",color:"text-gray-600 bg-gray-50"}},c=(0,a.createContext)(void 0);function l(e){let{children:t}=e,[r,l]=(0,a.useState)([]),[d,u]=(0,a.useState)(!0),{user:g,isAuthenticated:y}=(0,i.a)(),f=(0,a.useCallback)(async()=>{if(!(null==g?void 0:g.id)){l([]),u(!1);return}try{u(!0);let e=await fetch("/api/transactions?userId=".concat(g.id)),t=await e.json();if(e.ok&&t.success){let e=t.transactions.map(e=>{var t,r;return{...e,merchant:e.description,tags:[e.category.toLowerCase()],icon:(null===(t=s[e.category])||void 0===t?void 0:t.icon)||"ri-more-line",color:(null===(r=s[e.category])||void 0===r?void 0:r.color)||"text-gray-600 bg-gray-50"}});l(e)}else console.error("Failed to load transactions:",t.error),l([])}catch(e){console.error("Error loading transactions:",e),l([])}finally{u(!1)}},[null==g?void 0:g.id]);(0,a.useEffect)(()=>{y&&g?f():(l([]),u(!1))},[g,y,f]);let p=(0,a.useCallback)(async()=>{if(!(null==g?void 0:g.id))return!1;try{let e=await fetch("/api/budgets?userId=".concat(g.id)),t=await e.json();if(e.ok&&t.success)return t.budgets&&t.budgets.length>0;return!1}catch(e){return console.error("Error checking budgets:",e),!1}},[null==g?void 0:g.id]),h=async e=>{if(!(null==g?void 0:g.id))return n.ZP.error("User not authenticated"),!1;if(!await p())return n.ZP.error("Create a budget first before adding incomes or expenses."),!1;if("expense"===e.type&&!e.budgetId)return n.ZP.error("Please select a budget for this expense."),!1;try{let o=await fetch("/api/transactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,userId:g.id})}),a=await o.json();if(!o.ok||!a.success)return n.ZP.error(a.error||"Failed to add transaction"),!1;{var t,r;let e={...a.transaction,merchant:a.transaction.description,tags:[a.transaction.category.toLowerCase()],icon:(null===(t=s[a.transaction.category])||void 0===t?void 0:t.icon)||"ri-more-line",color:(null===(r=s[a.transaction.category])||void 0===r?void 0:r.color)||"text-gray-600 bg-gray-50"};return l(t=>[e,...t]),n.ZP.success("Transaction added successfully!"),!0}}catch(e){return console.error("Error adding transaction:",e),n.ZP.error("Failed to add transaction"),!1}},m=async(e,t)=>{if(!(null==g?void 0:g.id)){n.ZP.error("User not authenticated");return}try{let r=await fetch("/api/transactions",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,...t})}),o=await r.json();r.ok&&o.success?(l(r=>r.map(r=>{if(r.id===e){let e={...r,...t};if(t.category){var o,a;e.icon=(null===(o=s[t.category])||void 0===o?void 0:o.icon)||"ri-more-line",e.color=(null===(a=s[t.category])||void 0===a?void 0:a.color)||"text-gray-600 bg-gray-50"}return e}return r})),n.ZP.success("Transaction updated successfully!")):n.ZP.error(o.error||"Failed to update transaction")}catch(e){console.error("Error updating transaction:",e),n.ZP.error("Failed to update transaction")}},b=async e=>{if(!(null==g?void 0:g.id)){n.ZP.error("User not authenticated");return}try{let t=await fetch("/api/transactions?id=".concat(e),{method:"DELETE"}),r=await t.json();t.ok&&r.success?(l(t=>t.filter(t=>t.id!==e)),n.ZP.success("Transaction deleted successfully!")):n.ZP.error(r.error||"Failed to delete transaction")}catch(e){console.error("Error deleting transaction:",e),n.ZP.error("Failed to delete transaction")}},v=async e=>{if(!(null==g?void 0:g.id)){n.ZP.error("User not authenticated");return}try{let t=e.map(e=>fetch("/api/transactions?id=".concat(e),{method:"DELETE"})),r=await Promise.all(t),o=(await Promise.all(r.map(e=>e.json()))).filter(e=>e.success).length;o>0&&(l(t=>t.filter(t=>!e.includes(t.id))),n.ZP.success("".concat(o," transaction").concat(o>1?"s":""," deleted successfully!"))),o<e.length&&n.ZP.error("Failed to delete ".concat(e.length-o," transaction(s)"))}catch(e){console.error("Error deleting transactions:",e),n.ZP.error("Failed to delete transactions")}},w=(0,a.useCallback)(async()=>{await f()},[f]),P=(0,a.useCallback)(async e=>{if(!(null==g?void 0:g.id)){l([]),u(!1);return}try{u(!0);let t=await fetch("/api/transactions?userId=".concat(g.id,"&budgetId=").concat(e)),r=await t.json();if(t.ok&&r.success){let e=r.transactions.map(e=>{var t,r;return{...e,merchant:e.description,tags:[e.category.toLowerCase()],icon:(null===(t=s[e.category])||void 0===t?void 0:t.icon)||"ri-more-line",color:(null===(r=s[e.category])||void 0===r?void 0:r.color)||"text-gray-600 bg-gray-50"}});l(e)}else console.error("Failed to load transactions:",r.error),l([])}catch(e){console.error("Error loading transactions:",e),l([])}finally{u(!1)}},[null==g?void 0:g.id]),E=()=>r.filter(e=>e.amount>0).reduce((e,t)=>e+t.amount,0),T=()=>Math.abs(r.filter(e=>e.amount<0).reduce((e,t)=>e+t.amount,0));return(0,o.jsx)(c.Provider,{value:{transactions:r,addTransaction:h,updateTransaction:m,deleteTransaction:b,deleteMultipleTransactions:v,getTransactionsByCategory:e=>r.filter(t=>t.category===e),getTransactionsByBudget:e=>r.filter(t=>t.budgetId===e),getTransactionsByDateRange:(e,t)=>r.filter(r=>{let o=new Date(r.date),a=new Date(e),i=new Date(t);return o>=a&&o<=i}),getTotalIncome:E,getTotalExpenses:T,getNetIncome:()=>E()-T(),loading:d,refreshTransactions:w,loadTransactionsByBudget:P,checkBudgetsExist:p},children:t})}function d(){let e=(0,a.useContext)(c);if(void 0===e)throw Error("useTransactions must be used within a TransactionProvider");return e}}}]);