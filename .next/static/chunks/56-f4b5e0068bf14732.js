"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[56],{1891:function(e,t,o){o.d(t,{AuthProvider:function(){return l},a:function(){return s}});var r=o(7437),n=o(2265),a=o(9376),i=o(9064);let c=(0,n.createContext)(void 0);function l(e){let{children:t}=e,[o,l]=(0,n.useState)(null),[s,u]=(0,n.useState)(!0),d=(0,a.useRouter)();(0,n.useEffect)(()=>{(()=>{try{var e;let t=localStorage.getItem("user"),o=localStorage.getItem("authToken"),r=null===(e=document.cookie.split("; ").find(e=>e.startsWith("authToken=")))||void 0===e?void 0:e.split("=")[1];t&&(o||r)&&l(JSON.parse(t))}catch(e){console.error("Error checking auth:",e),localStorage.removeItem("user"),localStorage.removeItem("authToken"),document.cookie="authToken=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT"}finally{u(!1)}})()},[]);let m=async(e,t)=>{u(!0);try{let o=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),r=await o.json();if(!o.ok||!r.success)return i.ZP.error(r.error||"Invalid email or password"),!1;{let e="jwt-token-"+Date.now();return localStorage.setItem("user",JSON.stringify(r.user)),localStorage.setItem("authToken",e),document.cookie="authToken=".concat(e,"; path=/; max-age=").concat(604800),l(r.user),r.user.isDemo?i.ZP.success("Welcome to the demo!"):i.ZP.success("Welcome back!"),!0}}catch(e){return console.error("Login error:",e),i.ZP.error("Login failed. Please try again."),!1}finally{u(!1)}},f=async()=>{if(!(null==o?void 0:o.isDemo)){i.ZP.error("Only demo accounts can reset data");return}try{let e=await fetch("/api/demo/reset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o.email})}),t=await e.json();e.ok&&t.success?(i.ZP.success("Demo data reset successfully"),window.location.reload()):i.ZP.error(t.error||"Failed to reset demo data")}catch(e){console.error("Reset demo data error:",e),i.ZP.error("Failed to reset demo data")}},g=!!o;return(0,r.jsx)(c.Provider,{value:{user:o,isAuthenticated:g,isLoading:s,login:m,logout:()=>{try{localStorage.removeItem("user"),localStorage.removeItem("authToken"),localStorage.removeItem("notifications"),localStorage.removeItem("transactions"),localStorage.removeItem("settings"),document.cookie="authToken=; path=/; expires=Thu, 01 Jan 1970 00:00:01 GMT",l(null),i.ZP.success("Logged out successfully"),d.push("/auth/login")}catch(e){console.error("Logout error:",e),i.ZP.error("Error during logout")}},updateProfile:e=>{if(o){let t={...o,...e};l(t);try{localStorage.setItem("user",JSON.stringify(t)),i.ZP.success("Profile updated successfully")}catch(e){console.error("Error updating profile:",e),i.ZP.error("Failed to update profile")}}},resetDemoData:f},children:t})}function s(){let e=(0,n.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},56:function(e,t,o){o.d(t,{SettingsProvider:function(){return m},r:function(){return f}});var r=o(7437),n=o(2265),a=o(1891),i=o(8821);let c={theme:"light",compactMode:!1,animations:!0,fontSize:"medium",colorScheme:"blue",customPrimaryColor:void 0,layout:"default",cardStyle:"default",sidebarPosition:"left",sidebarCollapsed:!1},l={emailNotifications:!0,pushNotifications:!0,budgetAlerts:!0,weeklyReports:!0,monthlyReports:!0,goalReminders:!1,billReminders:!0,largeTransactions:!0,marketingEmails:!1,productUpdates:!0},s={firstName:"John",lastName:"Doe",email:"john.doe@example.com",phone:"+1 (555) 123-4567",timezone:"Eastern Time",language:"English",currency:"USD - US Dollar ($)",profilePicture:void 0},u={defaultBudgetPeriod:"monthly",rolloverUnused:!0,warningThreshold:80,autoSavePercentage:10,roundUpTransactions:!1,categorizeTransactions:!0,defaultCategories:["Food","Transportation","Entertainment","Utilities","Healthcare","Shopping"],currency:"ZMW",currencySymbol:"K",currencyPosition:"before",decimalPlaces:2,thousandsSeparator:",",decimalSeparator:"."},d=(0,n.createContext)(void 0);function m(e){let{children:t}=e,{user:o}=(0,a.a)(),[m,f]=(0,n.useState)(c),[g,p]=(0,n.useState)(l),[S,h]=(0,n.useState)(u),[v,y]=(0,n.useState)(s);return(0,n.useEffect)(()=>{(()=>{try{let e=(0,i.P0)("appearanceSettings",null==o?void 0:o.id),t=(0,i.Vv)(e);if(t)f({...c,...t});else{let t=localStorage.getItem("appearanceSettings");if(t)try{let r=JSON.parse(t);f({...c,...r}),(null==o?void 0:o.id)&&(0,i.TD)(e,r,i.iZ),localStorage.removeItem("appearanceSettings")}catch(e){console.error("Error migrating legacy appearance settings:",e)}}let r=localStorage.getItem("notificationSettings"),n=localStorage.getItem("budgetPreferences"),a=localStorage.getItem("profileSettings");if(r&&p(JSON.parse(r)),n){let e=JSON.parse(n);h({...u,...e})}if(a){let e=JSON.parse(a);y({...s,...e})}}catch(e){console.error("Error loading settings:",e)}})()},[null==o?void 0:o.id]),(0,n.useEffect)(()=>{o&&y(e=>{var t,r;return{...e,firstName:(null===(t=o.name)||void 0===t?void 0:t.split(" ")[0])||e.firstName,lastName:(null===(r=o.name)||void 0===r?void 0:r.split(" ").slice(1).join(" "))||e.lastName,email:o.email||e.email}})},[o]),(0,n.useEffect)(()=>{if(null==o?void 0:o.id)try{let e=(0,i.P0)("appearanceSettings",o.id);(0,i.TD)(e,m,i.iZ)}catch(e){console.error("Error saving appearance settings to cookies:",e)}},[m,null==o?void 0:o.id]),(0,n.useEffect)(()=>{try{localStorage.setItem("notificationSettings",JSON.stringify(g)),localStorage.setItem("budgetPreferences",JSON.stringify(S)),localStorage.setItem("profileSettings",JSON.stringify(v))}catch(e){console.error("Error saving settings to localStorage:",e)}},[g,S,v]),(0,n.useEffect)(()=>{o||f(c)},[o]),(0,r.jsx)(d.Provider,{value:{appearance:m,notifications:g,budgetPreferences:S,profile:v,updateAppearance:e=>{f(t=>({...t,...e}))},updateNotifications:e=>{p(t=>({...t,...e}))},updateBudgetPreferences:e=>{h(t=>({...t,...e}))},updateProfile:e=>{y(t=>({...t,...e}))},resetSettings:()=>{if(f(c),p(l),h(u),y(s),null==o?void 0:o.id){let e=(0,i.P0)("appearanceSettings",o.id);(0,i.kT)(e)}localStorage.removeItem("notificationSettings"),localStorage.removeItem("budgetPreferences"),localStorage.removeItem("profileSettings"),localStorage.removeItem("appearanceSettings")},formatCurrency:e=>{let{currencySymbol:t,currencyPosition:o,decimalPlaces:r,thousandsSeparator:n,decimalSeparator:a}=S,i=Math.abs(e).toFixed(r).split(".");i[0]=i[0].replace(/\B(?=(\d{3})+(?!\d))/g,n);let c=i.join(a),l="before"===o?"".concat(t).concat(c):"".concat(c).concat(t);return e<0?"-".concat(l):l},clearUserSettings:()=>{if(f(c),null==o?void 0:o.id){let e=(0,i.P0)("appearanceSettings",o.id);(0,i.kT)(e)}}},children:t})}function f(){let e=(0,n.useContext)(d);if(void 0===e)throw Error("useSettings must be used within a SettingsProvider");return e}},8821:function(e,t,o){function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/",o=arguments.length>2?arguments[2]:void 0;if("undefined"==typeof document)return;let r="".concat(encodeURIComponent(e),"=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=").concat(t);o&&(r+="; domain=".concat(o)),document.cookie=r}function n(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let r=JSON.stringify(t);!function(e,t){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if("undefined"==typeof document)return;let{expires:r,maxAge:n,path:a="/",domain:i,secure:c=!1,sameSite:l="lax"}=o,s="".concat(encodeURIComponent(e),"=").concat(encodeURIComponent(t));if(r){let e=r instanceof Date?r:new Date(Date.now()+1e3*r);s+="; expires=".concat(e.toUTCString())}void 0!==n&&(s+="; max-age=".concat(n)),s+="; path=".concat(a),i&&(s+="; domain=".concat(i)),c&&(s+="; secure"),s+="; samesite=".concat(l),document.cookie=s}(e,r,o)}catch(e){console.error("Error setting JSON cookie:",e)}}function a(e){try{let t=function(e){if("undefined"==typeof document)return null;let t=encodeURIComponent(e)+"=";for(let e of document.cookie.split(";"))if(0===(e=e.trim()).indexOf(t))return decodeURIComponent(e.substring(t.length));return null}(e);if(!t)return null;return JSON.parse(t)}catch(e){return console.error("Error parsing JSON cookie:",e),null}}function i(e,t){return t?"".concat(e,"_").concat(t):e}o.d(t,{P0:function(){return i},TD:function(){return n},Vv:function(){return a},iZ:function(){return c},kT:function(){return r}});let c={maxAge:31536e3,path:"/",sameSite:"lax",secure:!0}}}]);