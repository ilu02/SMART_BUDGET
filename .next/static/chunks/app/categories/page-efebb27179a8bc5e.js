(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[457],{6130:function(e,s,r){Promise.resolve().then(r.bind(r,9348))},9348:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return h}});var t=r(7437),i=r(2265),a=r(2037),l=r(9178),n=r(4226),c=r(8068),d=r(5998),o=r(1891),x=r(56),m=r(9064);let g=["ri-home-line","ri-car-line","ri-plane-line","ri-book-line","ri-music-line","ri-gamepad-line","ri-shopping-cart-line","ri-gift-line","ri-heart-line","ri-star-line","ri-sun-line","ri-moon-line","ri-fire-line","ri-leaf-line","ri-water-line","ri-lightning-line","ri-shield-line","ri-tools-line","ri-palette-line","ri-camera-line"],u=["bg-red-500","bg-orange-500","bg-yellow-500","bg-green-500","bg-teal-500","bg-blue-500","bg-indigo-500","bg-purple-500","bg-pink-500","bg-gray-500"];function h(){let{user:e}=(0,o.a)(),{formatCurrency:s}=(0,x.r)(),[r,h]=(0,i.useState)([]),[b,p]=(0,i.useState)(!0),[j,y]=(0,i.useState)(!1),[f,N]=(0,i.useState)(null),[v,w]=(0,i.useState)(!1),[C,P]=(0,i.useState)(null),[k,Z]=(0,i.useState)(""),[S,E]=(0,i.useState)({name:"",icon:"ri-star-line",color:"bg-blue-500",description:""});(0,i.useEffect)(()=>{e&&F()},[e]);let F=async()=>{if(!(null==e?void 0:e.id)){p(!1);return}try{p(!0);let s=await fetch("/api/budgets?userId=".concat(e.id)),r=await s.json();if(s.ok){let e=r.budgets.map((e,s)=>({id:e.id,name:e.category,icon:e.icon,color:e.color,budget:e.budget,spent:e.spent,isCustom:!1,description:e.description||""}));h(e)}else console.error("Failed to fetch categories:",r.error)}catch(e){console.error("Error fetching categories:",e)}finally{p(!1)}},T=async()=>{if(!S.name.trim()){m.ZP.error("Please enter a category name.");return}if(!(null==e?void 0:e.id)){m.ZP.error("User not authenticated");return}try{let s=await fetch("/api/budgets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e.id,category:S.name,budget:0,icon:S.icon,color:S.color,description:S.description})}),r=await s.json();if(s.ok&&r.success){let e={id:r.budget.id,name:r.budget.category,icon:r.budget.icon,color:r.budget.color,budget:r.budget.budget,spent:0,isCustom:!0,description:r.budget.description||""};h(s=>[...s,e]),E({name:"",icon:"ri-star-line",color:"bg-blue-500",description:""}),y(!1),m.ZP.success("Category created successfully!")}else m.ZP.error(r.error||"Failed to create category")}catch(e){console.error("Error creating category:",e),m.ZP.error("Failed to create category")}},O=e=>{N(e),E({name:e.name,icon:e.icon,color:e.color,description:e.description||""}),y(!0)},z=async()=>{if(!f||!S.name.trim()){m.ZP.error("Please enter a category name.");return}if(!(null==e?void 0:e.id)){m.ZP.error("User not authenticated");return}try{let e=await fetch("/api/budgets",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:f.id,category:S.name,icon:S.icon,color:S.color,description:S.description})}),s=await e.json();e.ok&&s.success?(h(e=>e.map(e=>e.id===f.id?{...e,name:S.name,icon:S.icon,color:S.color,description:S.description}:e)),N(null),E({name:"",icon:"ri-star-line",color:"bg-blue-500",description:""}),y(!1),m.ZP.success("Category updated successfully!")):m.ZP.error(s.error||"Failed to update category")}catch(e){console.error("Error updating category:",e),m.ZP.error("Failed to update category")}},B=async s=>{let t=r.find(e=>e.id===s);if(t){if(!t.isCustom){m.ZP.error("Cannot delete default categories.");return}if(t.spent>0){m.ZP.error("Cannot delete categories with existing transactions.");return}if(!(null==e?void 0:e.id)){m.ZP.error("User not authenticated");return}try{let e=await fetch("/api/budgets?id=".concat(s),{method:"DELETE"}),r=await e.json();e.ok&&r.success?(h(e=>e.filter(e=>e.id!==s)),m.ZP.success("Category deleted successfully!")):m.ZP.error(r.error||"Failed to delete category")}catch(e){console.error("Error deleting category:",e),m.ZP.error("Failed to delete category")}}},U=e=>{P(e),Z(""),w(!0)},_=async()=>{if(!C||!k.trim()){m.ZP.error("Please enter a budget amount.");return}let s=parseFloat(k);if(isNaN(s)||s<0){m.ZP.error("Please enter a valid budget amount.");return}if(!(null==e?void 0:e.id)){m.ZP.error("User not authenticated");return}try{let e=await fetch("/api/budgets",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:C.id,budget:s})}),r=await e.json();e.ok&&r.success?(h(e=>e.map(e=>e.id===C.id?{...e,budget:s}:e)),P(null),Z(""),w(!1),m.ZP.success("Budget set successfully!")):m.ZP.error(r.error||"Failed to set budget")}catch(e){console.error("Error setting budget:",e),m.ZP.error("Failed to set budget")}},I=()=>{w(!1),P(null),Z("")},A=()=>{y(!1),N(null),E({name:"",icon:"ri-star-line",color:"bg-blue-500",description:""})},$=r.reduce((e,s)=>e+(s.budget||0),0),D=r.reduce((e,s)=>e+s.spent,0);return b?(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(a.Z,{}),(0,t.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:(0,t.jsxs)("div",{className:"animate-pulse",children:[(0,t.jsx)("div",{className:"h-8 bg-gray-200 rounded w-64 mb-2"}),(0,t.jsx)("div",{className:"h-4 bg-gray-200 rounded w-96 mb-8"}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[void 0,void 0,void 0].map((e,s)=>(0,t.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,t.jsx)("div",{className:"h-16 bg-gray-200 rounded"})},s))}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[...Array(6)].map((e,s)=>(0,t.jsx)("div",{className:"bg-white p-6 rounded-lg shadow",children:(0,t.jsx)("div",{className:"h-32 bg-gray-200 rounded"})},s))})]})})]}):(0,t.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,t.jsx)(a.Z,{}),(0,t.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-8",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Budget Categories"}),(0,t.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage your spending categories and budgets"})]}),(0,t.jsxs)(n.z,{onClick:()=>y(!0),children:[(0,t.jsx)("i",{className:"ri-add-line mr-2","aria-hidden":"true"}),"Add Category"]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[(0,t.jsx)(l.Zb,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)("i",{className:"ri-folder-line text-blue-600 text-lg","aria-hidden":"true"})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Total Categories"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]})]})}),(0,t.jsx)(l.Zb,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)("i",{className:"ri-wallet-line text-green-600 text-lg","aria-hidden":"true"})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Total Budget"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:s($)})]})]})}),(0,t.jsx)(l.Zb,{className:"p-6",children:(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("div",{className:"w-10 h-10 bg-red-100 rounded-lg flex items-center justify-center",children:(0,t.jsx)("i",{className:"ri-arrow-up-line text-red-600 text-lg","aria-hidden":"true"})}),(0,t.jsxs)("div",{className:"ml-4",children:[(0,t.jsx)("p",{className:"text-sm text-gray-600",children:"Total Spent"}),(0,t.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:s(D)})]})]})})]}),(0,t.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:r.map(e=>(0,t.jsxs)(l.Zb,{className:"p-6 hover:shadow-md transition-shadow",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center ".concat(e.color," text-white"),children:(0,t.jsx)("i",{className:"".concat(e.icon," text-xl"),"aria-hidden":"true"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:e.name}),e.description&&(0,t.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("button",{onClick:()=>O(e),className:"p-2 text-gray-400 hover:text-blue-600 rounded-lg transition-colors","aria-label":"Edit category",children:(0,t.jsx)("i",{className:"ri-edit-line","aria-hidden":"true"})}),e.isCustom&&(0,t.jsx)("button",{onClick:()=>B(e.id),className:"p-2 text-gray-400 hover:text-red-600 rounded-lg transition-colors","aria-label":"Delete category",children:(0,t.jsx)("i",{className:"ri-delete-bin-line","aria-hidden":"true"})})]})]}),e.budget&&(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm mb-2",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Budget Progress"}),(0,t.jsxs)("span",{className:"font-medium",children:["$",e.spent," / $",e.budget]})]}),(0,t.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"h-2 rounded-full transition-all duration-300 ".concat(e.spent/e.budget>.9?"bg-red-500":e.spent/e.budget>.7?"bg-yellow-500":"bg-green-500"),style:{width:"".concat(Math.min(e.spent/e.budget*100,100),"%")}})}),(0,t.jsxs)("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[(0,t.jsxs)("span",{children:[(e.spent/e.budget*100).toFixed(1),"% used"]}),(0,t.jsxs)("span",{children:["$",(e.budget-e.spent).toFixed(2)," remaining"]})]})]}),(0,t.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-gray-600",children:"Transactions"}),(0,t.jsxs)("span",{className:"font-medium",children:["$",e.spent.toFixed(2)," spent"]})]}),!e.budget&&(0,t.jsx)("div",{className:"mt-4",children:(0,t.jsxs)(n.z,{variant:"outline",size:"sm",className:"w-full",onClick:()=>U(e),children:[(0,t.jsx)("i",{className:"ri-add-line mr-2","aria-hidden":"true"}),"Set Budget"]})})]},e.id))}),(0,t.jsxs)(d.u,{isOpen:j,onClose:A,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:f?"Edit Category":"Add New Category"}),(0,t.jsx)("button",{onClick:A,className:"text-gray-400 hover:text-gray-600 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 rounded-lg p-1","aria-label":"Close modal",children:(0,t.jsx)("i",{className:"ri-close-line text-2xl","aria-hidden":"true"})})]}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsx)("div",{children:(0,t.jsx)(c.I,{label:"Category Name",value:S.name,onChange:e=>E(s=>({...s,name:e.target.value})),placeholder:"Enter category name",required:!0})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-2",children:"Description (Optional)"}),(0,t.jsx)("textarea",{id:"description",value:S.description,onChange:e=>E(s=>({...s,description:e.target.value})),placeholder:"Enter category description",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 resize-none",rows:3})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Select Icon"}),(0,t.jsx)("div",{className:"grid grid-cols-8 gap-2",children:g.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>E(s=>({...s,icon:e})),className:"p-3 rounded-lg border-2 transition-all ".concat(S.icon===e?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),children:(0,t.jsx)("i",{className:"".concat(e," text-xl text-gray-600"),"aria-hidden":"true"})},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Select Color"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-2",children:u.map(e=>(0,t.jsx)("button",{type:"button",onClick:()=>E(s=>({...s,color:e})),className:"w-10 h-10 rounded-lg ".concat(e," border-2 transition-all ").concat(S.color===e?"border-gray-800 scale-110":"border-gray-300 hover:scale-105")},e))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Preview"}),(0,t.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-lg",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center ".concat(S.color," text-white"),children:(0,t.jsx)("i",{className:"".concat(S.icon," text-xl"),"aria-hidden":"true"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:S.name||"Category Name"}),S.description&&(0,t.jsx)("p",{className:"text-sm text-gray-500",children:S.description})]})]})]})]}),(0,t.jsxs)("div",{className:"flex space-x-4 mt-8",children:[(0,t.jsx)(n.z,{variant:"outline",onClick:A,className:"flex-1",children:"Cancel"}),(0,t.jsx)(n.z,{onClick:f?z:T,className:"flex-1",children:f?"Update Category":"Create Category"})]})]})]}),(0,t.jsxs)(d.u,{isOpen:v,onClose:I,children:[(0,t.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[(0,t.jsxs)("h2",{className:"text-2xl font-bold text-gray-900",children:["Set Budget for ",null==C?void 0:C.name]}),(0,t.jsx)("button",{onClick:I,className:"text-gray-400 hover:text-gray-600 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-500 focus-visible:ring-offset-2 rounded-lg p-1","aria-label":"Close modal",children:(0,t.jsx)("i",{className:"ri-close-line text-2xl","aria-hidden":"true"})})]}),(0,t.jsxs)("div",{className:"p-6",children:[(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)(c.I,{label:"Budget Amount",type:"number",value:k,onChange:e=>Z(e.target.value),placeholder:"Enter budget amount",min:"0",step:"0.01",required:!0}),(0,t.jsx)("p",{className:"text-sm text-gray-500 mt-2",children:"Set a monthly budget limit for this category"})]}),C&&(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Category"}),(0,t.jsxs)("div",{className:"flex items-center space-x-3 p-4 bg-gray-50 rounded-lg",children:[(0,t.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center ".concat(C.color," text-white"),children:(0,t.jsx)("i",{className:"".concat(C.icon," text-xl"),"aria-hidden":"true"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-gray-900",children:C.name}),C.description&&(0,t.jsx)("p",{className:"text-sm text-gray-500",children:C.description})]})]})]})]}),(0,t.jsxs)("div",{className:"flex space-x-4 mt-8",children:[(0,t.jsx)(n.z,{variant:"outline",onClick:I,className:"flex-1",children:"Cancel"}),(0,t.jsx)(n.z,{onClick:_,className:"flex-1",children:"Set Budget"})]})]})]})]})]})}}},function(e){e.O(0,[859,137,648,56,214,37,971,117,744],function(){return e(e.s=6130)}),_N_E=e.O()}]);